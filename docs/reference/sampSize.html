<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sample size calculations — sampSize • gMCP</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sample size calculations — sampSize" />
<meta property="og:description" content="Sample size calculations" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gMCP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8-15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kornl/gMCP/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample size calculations</h1>
    <small class="dont-index">Source: <a href='https://github.com/kornl/gMCP/blob/master/R/sampSize.R'><code>R/sampSize.R</code></a></small>
    <div class="hidden name"><code>sampSize.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sample size calculations</p>
    </div>

    <pre class="usage"><span class='fu'>sampSize</span><span class='op'>(</span>
  <span class='va'>graph</span>,
  <span class='va'>esf</span>,
  <span class='va'>effSize</span>,
  <span class='va'>powerReqFunc</span>,
  <span class='va'>target</span>,
  <span class='va'>corr.sim</span>,
  <span class='va'>alpha</span>,
  corr.test <span class='op'>=</span> <span class='cn'>NULL</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"quasirandom"</span>, <span class='st'>"pseudorandom"</span><span class='op'>)</span>,
  upscale <span class='op'>=</span> <span class='cn'>FALSE</span>,
  n.sim <span class='op'>=</span> <span class='fl'>10000</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>graph</th>
      <td><p>A graph of class <code><a href='graphMCP-class.html'>graphMCP</a></code>.</p></td>
    </tr>
    <tr>
      <th>esf</th>
      <td><p>...</p></td>
    </tr>
    <tr>
      <th>effSize</th>
      <td><p>...</p></td>
    </tr>
    <tr>
      <th>powerReqFunc</th>
      <td><p>One power requirement function or a list of these. 
<!-- % For example \code{function(x) {any(x)}} for at least one rejection or more complex user defined functions like \code{function(x) {(x[1]&amp;&amp;x[3])||(x[2]&amp;&amp;x[4])}}. -->
If one is interested in the power to reject hypotheses 1 and 3
one could specify: <br /><code>f=function(x) {x[1] &amp;&amp; x[3]}</code>.<br /> If the power
of rejecting hypotheses 1 and 2 is also of interest one would use a
(optionally named) list: <br /> 
<code>f=list(power1and3=function(x) {x[1] &amp;&amp; x[3]},</code><br />
<code>power1and2=function(x) {x[1] &amp;&amp; x[2]})</code>.
If the list has no names, the functions will be referenced 
to as "func1", "func2", etc. in the output.</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p>Target power that should be at least achieved. Either a numeric scalar between 0 and 1 or if parameter <code>powerReqFunc</code> is a list a numeric vector of the same length as <code>powerReqFunc</code>.</p></td>
    </tr>
    <tr>
      <th>corr.sim</th>
      <td><p>Covariance matrix under the alternative.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>...</p></td>
    </tr>
    <tr>
      <th>corr.test</th>
      <td><p>Correlation matrix that should be used for the parametric test.
If <code>corr.test==NULL</code> the Bonferroni based test procedure is used. Can contain
NAs.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>What type of random numbers to use. <code>quasirandom</code> uses a
randomized Lattice rule, and should be more efficient than
<code>pseudorandom</code> that uses ordinary (pseudo) random numbers.</p></td>
    </tr>
    <tr>
      <th>upscale</th>
      <td><p>Logical. If <code>upscale=FALSE</code> then for each intersection 
of hypotheses (i.e. each subgraph) a weighted test is performed at the 
possibly reduced level alpha of sum(w)*alpha, 
where sum(w) is the sum of all node weights in this subset.
If <code>upscale=TRUE</code> all weights are upscaled, so that sum(w)=1.</p></td>
    </tr>
    <tr>
      <th>n.sim</th>
      <td><p>...</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical, whether verbose output should be printed.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>...</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>In the parametric case there is more than one way to handle
subgraphs with less than the full alpha. If the parameter <code>test</code> is
missing, the tests are performed as described by Bretz et al. (2011), i.e.
tests of intersection null hypotheses always exhaust the full alpha level
even if the sum of weights is strictly smaller than one. If
<code>test="simple-parametric"</code> the tests are performed as defined in
Equation (3) of Bretz et al. (2011).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>...</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>graph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='exampleGraphs.html'>BonferroniHolm</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>
<span class='va'>powerReqFunc</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&amp;&amp;</span> <span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>||</span> <span class='va'>x</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>}</span>
<span class='co'>#TODO Still causing errors / loops.</span>
<span class='co'>#sampSize(graph, alpha=0.05, powerReqFunc, target=0.8, mean=c(6,4,2) )</span>
<span class='co'>#sampSize(graph, alpha=0.05, powerReqFunc, target=0.8, mean=c(-1,-1,-1), nsim=100)</span>
<span class='fu'>sampSize</span><span class='op'>(</span><span class='va'>graph</span>, esf<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>, effSize<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>, 
         corr.sim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>, powerReqFunc<span class='op'>=</span><span class='va'>powerReqFunc</span>, target<span class='op'>=</span><span class='fl'>0.8</span>, alpha<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>
<span class='va'>powerReqFunc</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>'all(x[c(1,2)])'</span><span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>,
                  <span class='st'>'any(x[c(0,1)])'</span><span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span>
<span class='fu'>sampSize</span><span class='op'>(</span>graph<span class='op'>=</span><span class='va'>graph</span>, 
         effSize<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"Scenario 1"</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>0.2</span>, <span class='fl'>0.2</span>, <span class='fl'>0.2</span><span class='op'>)</span>, 
                      <span class='st'>"Scenario 2"</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>4</span>, <span class='fl'>0.2</span>, <span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>, 
         esf<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.7071067811865476</span>, <span class='fl'>0.5</span>, <span class='fl'>0.7071067811865476</span><span class='op'>)</span>,
         powerReqFunc<span class='op'>=</span><span class='va'>powerReqFunc</span>, 
         corr.sim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>, target<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='fl'>0.8</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.025</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kornelius Rohmeyer, Florian Klinglmueller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


