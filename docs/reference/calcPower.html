<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate power values — calcPower • gMCP</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate power values — calcPower" />
<meta property="og:description" content="Given the distribution under the alternative (assumed to be multivariate
normal), this function calculates the power to reject at least one
hypothesis, the local power for the hypotheses as well as the expected
number of rejections." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gMCP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8-15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kornl/gMCP/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate power values</h1>
    <small class="dont-index">Source: <a href='https://github.com/kornl/gMCP/blob/master/R/calcPower.R'><code>R/calcPower.R</code></a></small>
    <div class="hidden name"><code>calcPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given the distribution under the alternative (assumed to be multivariate
normal), this function calculates the power to reject at least one
hypothesis, the local power for the hypotheses as well as the expected
number of rejections.</p>
    </div>

    <pre class="usage"><span class='fu'>calcPower</span><span class='op'>(</span>
  <span class='va'>weights</span>,
  <span class='va'>alpha</span>,
  <span class='va'>G</span>,
  mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>corr.sim</span><span class='op'>)</span><span class='op'>)</span>,
  corr.sim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>mean</span><span class='op'>)</span><span class='op'>)</span>,
  corr.test <span class='op'>=</span> <span class='cn'>NULL</span>,
  n.sim <span class='op'>=</span> <span class='fl'>10000</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"quasirandom"</span>, <span class='st'>"pseudorandom"</span><span class='op'>)</span>,
  f <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  upscale <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>graph</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>weights</th>
      <td><p>Initial weight levels for the test procedure (see graphTest
function). Alternatively a <code><a href='graphMCP-class.html'>graphMCP</a></code> object can be given as parameter <code>graph</code>.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Overall alpha level of the procedure, see graphTest function.
(For entangled graphs <code>alpha</code> should be a numeric vector of length 
equal to the number of graphs, each element specifying the partial alpha 
for the respective graph.
The overall alpha level equals <code><a href='https://rdrr.io/r/base/sum.html'>sum(alpha)</a></code>.)</p></td>
    </tr>
    <tr>
      <th>G</th>
      <td><p>Matrix determining the graph underlying the test procedure. Note
that the diagonal need to contain only 0s, while the rows need to sum to 1.
When multiple graphs should be used this needs to be a list containing the
different graphs as elements. Alternatively a <code><a href='graphMCP-class.html'>graphMCP</a></code> object can be given as parameter <code>graph</code>.</p></td>
    </tr>
    <tr>
      <th>mean</th>
      <td><p>Mean under the alternative</p></td>
    </tr>
    <tr>
      <th>corr.sim</th>
      <td><p>Covariance matrix under the alternative.</p></td>
    </tr>
    <tr>
      <th>corr.test</th>
      <td><p>Correlation matrix that should be used for the parametric test.
If <code>corr.test==NULL</code> the Bonferroni based test procedure is used. Can contain
NAs.</p></td>
    </tr>
    <tr>
      <th>n.sim</th>
      <td><p>Monte Carlo sample size. If type = "quasirandom" this number is
rounded up to the next power of 2, e.g. 1000 is rounded up to
\(1024=2^10\) and at least 1024.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>What type of random numbers to use. <code>quasirandom</code> uses a
randomized Lattice rule, and should be more efficient than
<code>pseudorandom</code> that uses ordinary (pseudo) random numbers.</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>List of user defined power functions (or just a single power
function).  If one is interested in the power to reject hypotheses 1 and 3
one could specify: <br /><code>f=function(x) {x[1] &amp;&amp; x[3]}</code>.<br /> If the power
of rejecting hypotheses 1 and 2 is also of interest one would use a
(optionally named) list: <br /> 
<code>f=list(power1and3=function(x) {x[1] &amp;&amp; x[3]},</code><br />
<code>power1and2=function(x) {x[1] &amp;&amp; x[2]})</code>.
If the list has no names, the functions will be referenced 
to as "func1", "func2", etc. in the output.</p></td>
    </tr>
    <tr>
      <th>upscale</th>
      <td><p>Logical. If <code>upscale=FALSE</code> then for each intersection 
of hypotheses (i.e. each subgraph) a weighted test is performed at the 
possibly reduced level alpha of sum(w)*alpha, 
where sum(w) is the sum of all node weights in this subset.
If <code>upscale=TRUE</code> all weights are upscaled, so that sum(w)=1.</p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>A graph of class <code><a href='graphMCP-class.html'>graphMCP</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For backwards compatibility. For example up to version 0.8-7
the parameters <code>corr.model</code> and <code>corr.test</code> were called <code>sigma</code>
and <code>cr</code>. Also instead of supplying a graph object one could 
supply a parameter <code>weights</code> and a transition matrix <code>G</code>.</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>In the parametric case there is more than one way to handle
subgraphs with less than the full alpha. If the parameter <code>test</code> is
missing, the tests are performed as described by Bretz et al. (2011), i.e.
tests of intersection null hypotheses always exhaust the full alpha level
even if the sum of weights is strictly smaller than one. If
<code>test="simple-parametric"</code> the tests are performed as defined in
Equation (3) of Bretz et al. (2011).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containg three elements</p><dl>
<dt><code>LocalPower</code></dt><dd><p>A numeric giving the local powers for the hypotheses</p></dd>
<dt><code>ExpRejections</code></dt><dd><p>The expected number of rejections</p></dd>
<dt><code>PowAtlst1</code></dt><dd><p>The power to reject at least one hypothesis</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bretz, F., Maurer, W., Brannath, W. and Posch, M. (2009) A graphical
approach to sequentially rejective multiple test procedures. Statistics in
Medicine, 28, 586--604</p>
<p>Bretz, F., Maurer, W. and Hommel, G. (2010) Test and power considerations
for multiple endpoint analyses using sequentially rejective graphical
procedures, to appear in Statistics in Medicine</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## reproduce example from Stat Med paper (Bretz et al. 2010, Table I)</span>
<span class='co'>## first only consider line 2 of Table I</span>
<span class='co'>## significance levels</span>
<span class='va'>graph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='exampleGraphs.html'>simpleSuccessiveII</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='co'>## alternative (mvn distribution)</span>
<span class='va'>corMat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.5</span>, <span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>,
                <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>0.5</span><span class='op'>)</span>,
                <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='fl'>0.5</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span><span class='op'>)</span>,
                <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>0.5</span>,<span class='fl'>0.5</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='fu'>calcPower</span><span class='op'>(</span>graph<span class='op'>=</span><span class='va'>graph</span>, alpha<span class='op'>=</span><span class='fl'>0.025</span>, mean<span class='op'>=</span><span class='va'>theta</span>, corr.sim<span class='op'>=</span><span class='va'>corMat</span>, n.sim<span class='op'>=</span> <span class='fl'>100000</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $LocalPower
#&gt;          H1          H2          H3          H4 
#&gt; 0.776237488 0.018638611 0.006774902 0.002502441 
#&gt; 
#&gt; $ExpRejections
#&gt; [1] 0.8041534
#&gt; 
#&gt; $PowAtlst1
#&gt; [1] 0.7763443
#&gt; 
#&gt; $RejectAll
#&gt; [1] 0.0006942749
#&gt; </div><div class='input'>

<span class='co'>## now reproduce all 14 simulation scenarios</span>
<span class='co'>## different graphs</span>
<span class='va'>weights1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, <span class='fl'>12</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>weights2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, <span class='fl'>12</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='va'>eps</span> <span class='op'>&lt;-</span> <span class='fl'>0.01</span>
<span class='va'>gam1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>10</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>-</span><span class='va'>eps</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='va'>gam2</span> <span class='op'>&lt;-</span> <span class='va'>gam1</span>
<span class='co'>## different multivariate normal alternatives</span>
<span class='va'>rho</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>8</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>0.99</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>th1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>7</span><span class='op'>)</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='va'>th2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>6</span><span class='op'>)</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>th3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>th4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>

<span class='co'>## function that calculates power values for one scenario</span>
<span class='va'>simfunc</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>nSim</span>, <span class='va'>a1</span>, <span class='va'>a2</span>, <span class='va'>g1</span>, <span class='va'>g2</span>, <span class='va'>rh</span>, <span class='va'>t1</span>, <span class='va'>t2</span>, <span class='va'>t3</span>, <span class='va'>t4</span>, <span class='va'>Gr</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>al</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>a1</span>, <span class='va'>a2</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>
  <span class='va'>G</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>g1</span>, <span class='fl'>1</span><span class='op'>-</span><span class='va'>g1</span>, <span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>g2</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>-</span><span class='va'>g2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>corMat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.5</span>, <span class='va'>rh</span>, <span class='va'>rh</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='va'>rh</span><span class='op'>/</span><span class='fl'>2</span>,<span class='va'>rh</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>rh</span>,<span class='va'>rh</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>rh</span><span class='op'>/</span><span class='fl'>2</span>,<span class='va'>rh</span>,<span class='fl'>0.5</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>t1</span>, <span class='va'>t2</span>, <span class='va'>t3</span>, <span class='va'>t4</span><span class='op'>)</span>
  <span class='fu'>calcPower</span><span class='op'>(</span>weights<span class='op'>=</span><span class='va'>al</span>, alpha<span class='op'>=</span><span class='fl'>0.025</span>, G<span class='op'>=</span><span class='va'>G</span>, mean<span class='op'>=</span><span class='va'>mean</span>, corr.sim<span class='op'>=</span><span class='va'>corMat</span>, n.sim <span class='op'>=</span> <span class='va'>nSim</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## calculate power for all 14 scenarios</span>
<span class='va'>outList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>14</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>outList</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>simfunc</span><span class='op'>(</span><span class='fl'>10000</span>, <span class='va'>weights1</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>weights2</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, 
                    <span class='va'>gam1</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>gam2</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>rho</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>th1</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>th2</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>th3</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>th4</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## summarize data as in Stat Med paper Table I </span>
<span class='va'>atlst1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>outList</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>PowAtlst1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>locpow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='st'>"rbind"</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>outList</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>LocalPower</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>atlst1</span>, <span class='va'>locpow</span><span class='op'>)</span>, <span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        atlst1      H1      H2      H3      H4
#&gt;  [1,] 0.02258 0.01245 0.01300 0.00128 0.00116
#&gt;  [2,] 0.77600 0.77588 0.01910 0.00677 0.00256
#&gt;  [3,] 0.77600 0.77594 0.02405 0.59717 0.00433
#&gt;  [4,] 0.77496 0.77496 0.02435 0.59729 0.02429
#&gt;  [5,] 0.40601 0.40515 0.02197 0.34906 0.02167
#&gt;  [6,] 0.11285 0.10840 0.01770 0.10193 0.01764
#&gt;  [7,] 0.89752 0.80463 0.80542 0.01233 0.01337
#&gt;  [8,] 0.89709 0.81067 0.81079 0.40710 0.40747
#&gt;  [9,] 0.89758 0.81085 0.81116 0.35443 0.35382
#&gt; [10,] 0.89771 0.80994 0.80975 0.44189 0.44067
#&gt; [11,] 0.77618 0.77606 0.02454 0.24915 0.00427
#&gt; [12,] 0.77472 0.77466 0.02325 0.65338 0.00458
#&gt; [13,] 0.85095 0.85095 0.02393 0.75946 0.00427
#&gt; [14,] 0.02441 0.02441 0.02405 0.02429 0.00171</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kornelius Rohmeyer, Florian Klinglmueller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


